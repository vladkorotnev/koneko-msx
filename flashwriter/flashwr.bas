5 CLS:PRINT"KONEKOFlash1.0"
10 '_COMINI("0:8N1NNNNN",9600,9600,0)
20 CLEAR100,&hf000
25 PRINT"Load PROG":A=&hC000:GOSUB400
120 DEFUSR=&hC000:DEFUSR1=&hC003:DEFUSR2=&hC006
130 PRINT"Find Flash":X=USR(0)AND255
140 IFX<>&hBFTHENPRINT"NOT FOUND":A$="N":GOSUB500:GOTO399

150 PRINT"FORMAT FLASH":X=USR1(0)

160 PRINT"QADDR":A$="A":GOSUB500:A=&hC300:GOSUB400

170 PRINT"QDATA":A$="?":GOSUB500:A=&hD000:GOSUB400:X=USR2(0)
180 IFX<>0THENPRINT"WR FAIL "+HEX$(X):A$="E":GOSUB500:GOTO399
190 GOTO160

399 END

400 OPEN"com:"FORINPUTAS#1
410 IFEOF(1)THEN470
420 LINEINPUT#1,L$:PRINTL$;
430 IFL$="Q"THENPRINT"END":CLOSE#1:GOTO399
440 POKEA,VAL("&h"+L$)
450 A=A+1
460 GOTO410
470 CLOSE#1:PRINT"#"
480 RETURN

500 OPEN"com:"FOROUTPUTAS#1
510 PRINT#1,A$
520 CLOSE#1
530 RETURN
