5 CLS:PRINT"KONEKOFlash1.0"
10 CLEAR100,&hf000
20 _COMINI("0:8N1NNNNN",9600,9600,0)
21 OPEN"COM:"AS#1
25 PRINT"Load PROG":A=&hC000:GOSUB400
120 DEFUSR=&hC000:DEFUSR1=&hC003:DEFUSR2=&hC006
130 PRINT"Find Flash":X=USR(0)AND255
140 IFX<>&hBFTHENPRINT"NOT FOUND":A$="N":GOSUB500:GOTO399

150 PRINT"FORMAT FLASH":X=USR1(0)

160 PRINT"QADDR":A$="A":GOSUB500:A=&hC300:GOSUB400

170 PRINT"QDATA":A$="?":GOSUB500:A=&hD000:GOSUB400:X=USR2(0)
180 IFX<>0THENPRINT"WR FAIL "+HEX$(X):A$="E":GOSUB500:GOTO399
185 FORJ=0TO100STEP1:PRINT".";:NEXTJ
190 GOTO160

399 CLOSE#1:END

400 LINEINPUT#1,L$:PRINTL$;
410 IFL$="Q"THENPRINT"END":GOTO399
415 IFL$="Z"THEN450
420 POKEA,VAL("&h"+L$)
430 A=A+1
440 GOTO400
450 PRINT"#":RETURN

500 PRINT#1,A$
510 RETURN
